import{j as e}from"./jsx-runtime.391947bd.js";import{r as a}from"./index.ed373d49.js";import{s as w}from"./toast.421cbc24.js";function q(){const[x,n]=a.useState(""),[o,p]=a.useState(null),[m,u]=a.useState(null),[i,l]=a.useState(!1),[f,g]=a.useState(null),[h,j]=a.useState([]);async function v(t){t.preventDefault();const s=new FormData(t.target),d=s.get("eventoUID"),y=s.get("name");if(!d||!y){n("completa todos los campos");return}else{s.append("video",m);try{l(!0);const r=await(await fetch("/api/feedback",{method:"POST",body:s})).json();g(r),r.message&&r.name&&(l(!1),p(r.qr),w("üéûÔ∏è Video Cargado",3e3),n(!1),u(!1),t.target.reset())}catch(c){console.log(c),l(!1),n(c)}}}const b=t=>{u(t.target.files[0])};return a.useEffect(()=>{(async()=>{try{const d=await(await fetch("api/eventos")).json();j(d.eventos)}catch(s){console.error("Error:",s)}})()},[]),e.jsxs(e.Fragment,{children:[i&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-white/60 backdrop-blur-sm flex items-center justify-center",children:e.jsxs("div",{children:[e.jsxs("div",{class:"lds-ellipsis",children:[e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{})]}),e.jsx("p",{className:"mx-auto animate-pulse text-xs font-medium text-green-500",children:"espera, estamos cargando tu video ‚åõ"})]})}),e.jsxs("form",{onSubmit:v,className:"flex flex-col items-center text-gray-700",children:[e.jsxs("select",{name:"eventoUID",id:"eventos",required:!0,className:"p-2 text-xs rounded-lg my-3 ring-0 border-none",onChange:t=>{const s=t.target.value;formData.append("evento",s)},children:[e.jsx("option",{value:"noSelect",disabled:!0,selected:!0,className:"text-sx p-2 rounded-lg font-medium text-gray-400",children:"Selecciona un Evento"}),h?.map(t=>e.jsx("option",{value:t.uid,children:t.name}))]}),e.jsxs("label",{htmlFor:"name",className:"my-5 border flex items-center justify-between bg-white rounded-lg p-5 w-full gap-2 text-sm",children:[e.jsx("p",{children:"Mesa N¬∞"}),e.jsx("input",{type:"text",id:"name",name:"name",required:!0,className:"rounded-lg ring-0 border p-2"})]}),m?e.jsx("div",{className:"my-5 cursor-pointer text-center border flex items-center justify-between bg-white rounded-lg p-5 w-full gap-2 text-sm",children:e.jsxs("p",{className:"mx-auto text-green-400 font-medium",children:["Video Cargado üëåüèº"," "]})}):e.jsxs("label",{htmlFor:"video",className:"my-5 cursor-pointer text-center border flex items-center justify-between bg-white rounded-lg p-5 w-full gap-2 text-sm",children:[e.jsx("p",{className:"mx-auto animate-pulse text-xs font-medium",children:"Click aqui para cargar tu video üìÇ"}),e.jsx("input",{type:"file",id:"video",name:"video",required:!0,accept:".mp4",className:"hidden",onChange:b})]}),i&&e.jsx("span",{className:"text-sm font-medium text-orange-500 animate-pulse",children:"cargando video..."}),e.jsx("button",{disabled:i,className:"disabled:bg-gray-200 cursor-pointer  border flex items-center justify-center hover:bg-blue-400 duration-200 hover:ring-2 bg-blue-500 text-white font-medium rounded-lg p-2 text-center w-2/3 gap-2 text-sm",children:"Cargar"}),o&&e.jsxs("div",{className:"p-2 my-5 space-y-4 flex flex-col items-center",children:[e.jsx("p",{className:"text-xs font-medium",children:"Toca la imagen para descargar y usarla como quieras"}),e.jsxs("a",{className:" mx-auto cursor-pointer",href:o,download:f.name,children:[" ",e.jsx("img",{alt:"qrCode",src:o,width:100,height:100})]})]}),e.jsx("span",{className:"text-sm font-thin text-red-500",children:x})]})]})}export{q as default};
